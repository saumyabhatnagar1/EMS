<div class="jumbotron">
  <!-- <pagination-template #p="paginationApi"> -->
  

  <div class="card" style="width: 32rem; height: 8rem; background-color: #1576d1;">
    <h1 class="card-body">Active Projects</h1>
  </div>
  <button class="button addButton btn btn-primary" data-target="#projectModal" data-toggle="modal">+</button>
  

  <div class="row">
    <div class="col-lg-6">
  

      <div class="table1">
        <table class="table table-hover table-striped table-responsive-" style="width: 80%;">


          <tbody>
            <tr><th>S.No</th><th>P.Id</th><th>Name</th><th>Team</th><th>Info</th></tr>
            <tr *ngFor="let proj of projects |paginate : {id :'listing_pagination',
        itemsPerPage : 3,
        currentPage: page}; index as i">
              
              <td>{{i+1}}</td>
              <td>{{proj.project_id}}</td>
              <td>{{proj.name}}</td>
              <td><button style="padding: 0;border: none;background: none; color: black;" (click)="count=i"
                  class="btn btn-success" data-toggle="modal" data-target="#teamModal"
                  (click)="pid_team=i;">Team</button></td>
              <td><button style="border-radius: 50%;" (click)="getTask(proj.project_id); show=true" >&iexcl;</button></td>
            </tr>
          </tbody>
        </table>
        <br>
        <div>
          <pagination-controls class="my-pagination" id="listing_pagination" maxSize="5" directionLinks="true"
            (pageChange)="page = $event"></pagination-controls>
        </div>
      </div>
    </div>



    <div *ngIf="show" class="col-lg-6">
      <div class="table2">
      <h3>Task ids
      <button data-target="#addTaskModal" data-toggle="modal" class="btn btn-primary" style="float: right;">Add Task</button>
      </h3>
      <table class="table table-hover table-striped">
        <tr><th>Id</th><th>Assignee</th><th>Description</th><th>Completed</th></tr>
        <tr *ngFor="let t of tasks;index as i"  (click)="task_id=i;" data-toggle="modal" data-target="#taskModal" style="cursor: pointer;" class="">
          
          <td>{{t.project_id}}</td>
          <td>{{t.assignee}}</td>
          <td>{{t.description}}</td>
          <td>{{t.completed}}</td>

        </tr>
      </table>
    </div>
  </div>
  </div>
</div>

<div *ngIf="projects.length>0">
<div class="modal fade" id="teamModal">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h4>Team Info</h4>

      </div>
      <div class="modal-body">
        <table class="tableTeam">
          <tr>
            <th>{{projects[0].team.email}}</th>
            <th>{{projects[0].team.role}}</th>
          </tr>

        </table>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-dismiss="modal" style="background-color:#0362fc;">Ok</button>
      </div>
    </div>
  </div>
</div>
</div>



<div class="modal fade" id="projectModal">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <h4>Add project</h4>
        
      </div>
      <div class="modal-body">
        <form action="" [formGroup]="projectForm">
          <label for=""> Name
            <input type="text" formControlName="name" placeholder="Project Name" class="form-control">
          </label>


          <div formArrayName="team" #t2>
            <div *ngFor='let t of team.controls;index as i'>
              <div [formGroupName]="i">
                <input type="text" formControlName="email" placeholder="Member" class="form-control">
                <input type="text" formControlName="role" placeholder="Role" class="form-control">
                <button (click)="addTeam(t2)">Add</button>
              </div>
            </div>
          </div>






          <button type="submit" class="btn btn-primary" (click)="addProject()"> Submit</button>
        </form>

      </div>

    </div>
  </div>




</div>


<div class="modal fade" id="addTaskModal">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4>Add Task</h4>
        <!-- <button class="close" data-dismiss="modal">&times;</button> -->
      </div>
      <div class="modal-body">
        <form action="" [formGroup]="taskForm">
          <label for=""> Project Id
            <input type="text" formControlName="project_id" placeholder="project id" class="form-control">
          </label>
          <label for=""> Task Description
            <input type="text" formControlName="description" placeholder="description" class="form-control">
          </label>
          <label for=""> Assignee
            <input type="text" formControlName="assignee" placeholder="assignee" class="form-control">
          </label>


          <button type="submit" class="btn btn-primary" (click)="onTaskSubmit()" data-dismiss="modal">Submit</button>
        </form>

      </div>

    </div>
  </div>
</div>

<div *ngIf="tasks.length>0">
<div class="modal fade" id="taskModal">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <h4>Task Info</h4>

      </div>
      <div class="modal-body">
        <table class="table table-hover table-bordered">
          <tr>
            <th>Project Id</th>
            <th>Assignee</th>
            <th>Completed</th>
            <th>Description</th>
          </tr>
          <tr>

            <td>{{tasks[task_id].project_id}}</td>
            <td>{{tasks[task_id].assignee}}</td>
      
            <td>{{tasks[task_id].completed}}</td>
            <td>{{tasks[task_id].description}}</td>
          </tr>

        </table>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-dismiss="modal" style="background-color:#0362fc;">Ok</button>
      </div>
    </div>
  </div>
</div>
</div>
